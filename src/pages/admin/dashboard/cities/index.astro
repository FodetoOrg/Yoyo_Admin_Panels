---
import Layout from '../_layout.astro';
import NotFound from "@/components/NotFound";
---

<Layout title="Dashboard">
  <div id="cities-content">
    <NotFound 
      title="Access Denied"
      description="This page is only available to super administrators."
      pageRedirect="/admin/dashboard"
      pageRedirectText="Go to Dashboard"
    />
  </div>
</Layout>

<script>
  // Check user role and view-as context
  const currentUser = { role: "super_admin" }; // This should come from auth
  const viewAsHotel = localStorage.getItem("viewAsHotel");
  const effectiveRole = viewAsHotel && currentUser.role === "super_admin" ? "hotel_admin" : currentUser.role;
  
  // Only show cities dashboard for super admin (not when viewing as hotel admin)
  if (effectiveRole === "super_admin") {
    // Load the actual cities dashboard
    import('./_components/CityDashboard').then(({ default: CityDashboard }) => {
      import('./_components/CitySelector').then(({ default: CitySelector }) => {
        // In a real app, you'd properly mount these React components
        const content = document.getElementById("cities-content");
        if (content) {
          content.innerHTML = `
            <div class="space-y-4">
              <div class="text-lg font-semibold">Cities Dashboard</div>
              <p class="text-muted-foreground">Select a city to view detailed analytics</p>
              <!-- City selector and dashboard would be mounted here -->
            </div>
          `;
        }
      });
    });
  }
</script>