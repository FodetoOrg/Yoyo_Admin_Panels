---
import DashboardLayout from "../../../layouts/DashboardLayout.astro";
import Screen from "./_components/Screen";
import { serverApiService, type ApiResponse } from "../../../lib/utils/api";
import { CONSTANTS, ROUTES } from "../../../lib/utils/constants";
import { UserRole, redirectIfUnauthorized } from "@/lib/utils/auth";

// Only super admin can access cities management
const redirectResponse = redirectIfUnauthorized(Astro, UserRole.SUPER_ADMIN);
if (redirectResponse) return redirectResponse;

const cities: ApiResponse<any> = await serverApiService.get(
  ROUTES.GET_CITIES_ROUTE,
  Astro.cookies.get(CONSTANTS.ACCESS_TOKEN_KEY)?.value || "",
  Astro.cookies
);
---

<DashboardLayout title="Hotels">
  <Screen cities={cities?.data || []} client:load />
</DashboardLayout>
